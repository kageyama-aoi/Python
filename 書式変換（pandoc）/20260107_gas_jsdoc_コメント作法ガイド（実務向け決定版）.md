# GAS × JSDoc コメント作法ガイド（実務向け決定版）

> **目的**  
> GAS のコードに「意味が残るコメント」を最小コストで書く。  
> 文法暗記ではなく、**使いどころが分かる**ことをゴールにする。

---

## このガイドで扱う範囲
- 覚えておくと **8割以上得をする** JSDoc タグ
- GAS（Apps Script）前提の現実的な書き方
- 型チェックより **設計の見える化** を重視

---

## まず覚えるべき5つ（メジャーどころ）

| 番号 | タグ | 何のため | 主な使いどころ |
|---|---|---|---|
| 1 | @param | 関数の入口を説明 | 関数定義 |
| 2 | @return | 関数の出口を説明 | 関数定義 |
| 3 | @typedef | オブジェクト構造の設計図 | 設定・データ構造 |
| 4 | @type | 変数・定数の型 | 定数・共有変数 |
| 5 | @fileoverview | ファイルの責務 | ファイル冒頭 |

---

## 1. @param / @return（関数の契約）

### 使うシチュエーション
- 関数を定義するとき
- 他人 or 未来の自分が呼び出す関数

```javascript
/**
 * メールを検索して一覧を返す
 * @param {string} query Gmail検索条件
 * @return {Array<object>} メール一覧
 */
function searchMails(query) {}
```

- **@param**：関数に渡す値
- **@return**：関数が返す値

→ 関数の **契約書** と考えると分かりやすい。

---

## 2. @type（この変数は何か？）

### 使うシチュエーション
- ID や設定値など、意味のある定数
- GAS のゆるい型で事故を防ぎたいとき

```javascript
/** @type {string} */
const SPREADSHEET_ID = "xxxx";
```

→ 「これは文字列IDだよ」と宣言する役目。

---

## 3. @typedef（オブジェクトの設計図）

### 使うシチュエーション
- 設定オブジェクト
- API / Gmail / Drive など連携データ
- 同じ構造を複数箇所で使う

```javascript
/**
 * メールレポート設定
 * @typedef {Object} MailReportSetting
 * @property {string} condition Gmail検索条件
 * @property {string} outputSheetName 出力先シート名
 * @property {number=} max 最大取得件数（省略可）
 * @property {string} parserType パーサー種別
 */
```

### どう使うか

```javascript
/** @type {MailReportSetting} */
const setting = {
  condition: 'subject:"完了"',
  outputSheetName: '一覧',
  max: 50,
  parserType: 'keyValue'
};
```

→ **@typedef は型を作る側**、@param はそれを使う側。

---

## @property と @param の違い（重要）

| タグ | 主語 | 役割 |
|---|---|---|
| @property | オブジェクト | 中身の説明 |
| @param | 関数 | 引数の説明 |

### @property の例
```javascript
/**
 * @typedef {Object} User
 * @property {string} name
 * @property {number} age
 */
```

### @param の例
```javascript
/**
 * @param {User} user
 */
function saveUser(user) {}
```

→ **データ構造 vs 関数契約** の違い。

---

## 4. @fileoverview（このファイルは何をする？）

### 使うシチュエーション
- 複数ファイル構成の GAS
- 役割でコードを分けている場合

```javascript
/**
 * @fileoverview メールレポート設定を管理する
 */
```

→ GAS は境界が見えにくいので、ここが効く。

---

## 書き方の実務ルール（これだけ）

1. JSDoc は **直後の要素1つにだけ対応**させる
2. 型は厳密より **構造が分かることを優先**
3. 運用メモは `// TODO:` に分離
4. 迷ったら「未来の自分が読めるか」で判断

---

## 最低限テンプレ（コピペ用）

```javascript
/**
 * @fileoverview 〇〇管理
 */

/**
 * @typedef {Object} Data
 * @property {string} id
 */

/** @type {string} */
const ID = 'xxx';

/**
 * @param {Data} data
 * @return {boolean}
 */
function run(data) {}
```

---

## まとめ
- JSDoc は型チェックではなく **設計メモ**
- @typedef と @fileoverview が境界を作る
- 少数精鋭で十分、細かい文法は不要

> 「これは覚えた方が得」だけを残したガイド

