import csv
import os


def build_rows():
    return [
        {
            "case_id": "CASE-000",
            "table": "orders",
            "operation": "INSERT",
            "trigger": "新規作成",
            "attr_type": "order_status",
            "before": "NULL",
            "after": "NEW",
            "note": "初回作成",
            "sql": "INSERT INTO orders ...",
        },
        {
            "case_id": "CASE-000",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_amount",
            "before": "NULL",
            "after": "1000",
            "note": "初期金額",
            "sql": "",
        },
        {
            "case_id": "CASE-000",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_paid_at",
            "before": "NULL",
            "after": "NULL",
            "note": "未決済",
            "sql": "",
        },
        {
            "case_id": "CASE-001",
            "table": "orders",
            "operation": "UPDATE",
            "trigger": "注文確定",
            "attr_type": "order_status",
            "before": "NEW",
            "after": "PAID",
            "note": "決済完了",
            "sql": "UPDATE orders SET ...",
        },
        {
            "case_id": "CASE-001",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_amount",
            "before": "1000",
            "after": "1000",
            "note": "金額変更なし",
            "sql": "",
        },
        {
            "case_id": "CASE-001",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_paid_at",
            "before": "NULL",
            "after": "2026-02-01",
            "note": "決済日時",
            "sql": "",
        },
        {
            "case_id": "CASE-001",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_deleted_flag",
            "before": "0",
            "after": "0",
            "note": "変更なし",
            "sql": "",
        },
        {
            "case_id": "CASE-002",
            "table": "orders",
            "operation": "UPDATE",
            "trigger": "キャンセル",
            "attr_type": "order_status",
            "before": "PAID",
            "after": "CANCEL",
            "note": "ユーザー操作",
            "sql": "UPDATE orders SET ...",
        },
        {
            "case_id": "CASE-002",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_canceled_at",
            "before": "NULL",
            "after": "2026-02-02",
            "note": "取消日時",
            "sql": "",
        },
        {
            "case_id": "CASE-002",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_amount",
            "before": "1000",
            "after": "1000",
            "note": "金額変更なし",
            "sql": "",
        },
        {
            "case_id": "CASE-003",
            "table": "orders",
            "operation": "UPDATE",
            "trigger": "SupportTool",
            "attr_type": "order_status",
            "before": "CANCEL",
            "after": "REFUND",
            "note": "",
            "sql": "UPDATE orders SET status='canceled' WHERE ...",
        },
        {
            "case_id": "CASE-003",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_canceled_at",
            "before": "",
            "after": "2026-02-03",
            "note": "",
            "sql": "",
        },
        {
            "case_id": "CASE-003",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_amount",
            "before": "1000",
            "after": "NULL",
            "note": "",
            "sql": "",
        },
        {
            "case_id": "CASE-004",
            "table": "orders",
            "operation": "DELETE",
            "trigger": "BatchJob",
            "attr_type": "order_deleted_flag",
            "before": "0",
            "after": "1",
            "note": "",
            "sql": "DELETE FROM orders WHERE ...",
        },
        {
            "case_id": "CASE-004",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "order_status",
            "before": "REFUND",
            "after": "REFUND",
            "note": "変更なし",
            "sql": "",
        },
        {
            "case_id": "CASE-005",
            "table": "payments",
            "operation": "UPDATE",
            "trigger": "AdminUI",
            "attr_type": "payment_amount",
            "before": "1000",
            "after": "1500",
            "note": "手動調整",
            "sql": "UPDATE payments SET amount=1500 WHERE ...",
        },
        {
            "case_id": "CASE-005",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "payment_status",
            "before": "PENDING",
            "after": "PAID",
            "note": "",
            "sql": "",
        },
        {
            "case_id": "CASE-005",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "payment_method",
            "before": "card",
            "after": "card",
            "note": "変更なし",
            "sql": "",
        },
        {
            "case_id": "CASE-006",
            "table": "customers",
            "operation": "UPDATE",
            "trigger": "RefundAPI",
            "attr_type": "customer_status",
            "before": "ACTIVE",
            "after": "SUSPENDED",
            "note": "返金により停止",
            "sql": "UPDATE customers SET status='SUSPENDED' WHERE ...",
        },
        {
            "case_id": "CASE-006",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "customer_tier",
            "before": "GOLD",
            "after": "SILVER",
            "note": "",
            "sql": "",
        },
        {
            "case_id": "CASE-006",
            "table": "",
            "operation": "",
            "trigger": "",
            "attr_type": "customer_last_paid_at",
            "before": "2026-02-02",
            "after": "NULL",
            "note": "",
            "sql": "UPDATE customers SET paid_at=NULL WHERE ...",
        },
    ]


def main():
    output_dir = os.path.join("data", "input")
    os.makedirs(output_dir, exist_ok=True)
    output_path = os.path.join(output_dir, "data_flow_dummy.csv")

    rows = build_rows()
    headers = [
        "case_id",
        "table",
        "operation",
        "trigger",
        "attr_type",
        "before",
        "after",
        "note",
        "sql",
    ]

    with open(output_path, "w", newline="", encoding="utf-8") as f:
        writer = csv.DictWriter(f, fieldnames=headers)
        writer.writeheader()
        writer.writerows(rows)

    print(f"Generated: {output_path}")


if __name__ == "__main__":
    main()
