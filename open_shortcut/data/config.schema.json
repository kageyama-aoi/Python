{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Open Shortcut Configuration",
    "description": "Configuration file for the Open Shortcut application.",
    "type": "object",
    "properties": {
        "settings": {
            "type": "object",
            "properties": {
                "window_title": {"type": "string"},
                "geometry": {"type": "string", "pattern": "^\\d+x\\d+$"},
                "resizable": {
                    "type": "array",
                    "items": {"type": "boolean"},
                    "minItems": 2,
                    "maxItems": 2
                },
                "icon_folder": {"type": "string"},
                "window_icon": {"type": "string"},
                "default_button_icon": {"type": "string"},
                "initial_page": {"type": "string"}
            },
            "required": ["window_title", "icon_folder", "initial_page"]
        },
        "styles": {
            "type": "object",
            "description": "ttk widget styles"
        },
        "pages": {
            "type": "object",
            "description": "Application pages",
            "patternProperties": {
                "^[a-zA-Z0-9_]+$": {
                    "type": "object",
                    "properties": {
                        "title": {"type": "string"},
                        "window_title": {"type": "string"},
                        "entries": {
                            "type": "array",
                            "items": { "$ref": "#/$defs/entry" }
                        }
                    },
                    "required": ["title", "entries"]
                }
            }
        }
    },
    "required": ["settings", "styles", "pages"],

    "$defs": {
        "entry_common_properties": {
            "type": "object",
            "properties": {
                "active": {
                    "type": "boolean",
                    "default": true,
                    "description": "Whether the entry is active and should be displayed/functional."
                },
                "name": {"type": "string", "description": "Display name of the button."},
                "icon": {"type": ["string", "null"], "description": "Filename of the icon to display."}, 
                "background": {"type": "string", "description": "Background color of the button (e.g., #RRGGBB)."},
                "foreground": {"type": "string", "description": "Foreground color of the button (e.g., #RRGGBB)."}
            },
            "required": ["name"]
        },
        "open_directory_entry": {
            "allOf": [
                { "$ref": "#/$defs/entry_common_properties" },
                {
                    "properties": {
                        "action": {"const": "open_directory"},
                        "path": {"type": "string", "description": "Path to directory/file."}
                    },
                    "required": ["action", "path"]
                }
            ]
        },
        "open_url_entry": {
            "allOf": [
                { "$ref": "#/$defs/entry_common_properties" },
                {
                    "properties": {
                        "action": {"const": "open_url"},
                        "url": {"type": "string", "format": "uri", "description": "URL to open."}
                    },
                    "required": ["action", "url"]
                }
            ]
        },
        "show_page_entry": {
            "allOf": [
                { "$ref": "#/$defs/entry_common_properties" },
                {
                    "properties": {
                        "action": {"const": "show_page"},
                        "target": {"type": "string", "description": "Target page name for show_page action."}
                    },
                    "required": ["action", "target"]
                }
            ]
        },
        "parameterized_url_entry": {
            "allOf": [
                { "$ref": "#/$defs/entry_common_properties" },
                {
                    "properties": {
                        "action": {"const": "open_parameterized_url"},
                        "base_url": {"type": "string", "format": "uri-template", "description": "Base URL with placeholders (e.g., https://example.com/{param})."},
                        "parameters": {
                            "type": "array",
                            "items": { "$ref": "#/$defs/parameter_definition" }
                        }
                    },
                    "required": ["action", "base_url", "parameters"]
                }
            ]
        },
        "separator_entry": {
            "type": "object",
            "properties": {
                "type": {"const": "separator"},
                "active": {
                    "type": "boolean",
                    "default": true,
                    "description": "Whether the separator is active and should be displayed."
                }
            },
            "required": ["type"]
        },
        "parameter_definition": {
            "type": "object",
            "properties": {
                "name": {"type": "string"},
                "label": {"type": "string"},
                "type": {"type": "string", "enum": ["text", "pulldown"]},
                "default_value": {"type": "string"},
                "options": {
                    "type": "array",
                    "items": {"type": "string"}
                }
            },
            "required": ["name", "type"]
        },
        "entry": {
            "oneOf": [
                { "$ref": "#/$defs/open_directory_entry" },
                { "$ref": "#/$defs/open_url_entry" },
                { "$ref": "#/$defs/show_page_entry" },
                { "$ref": "#/$defs/parameterized_url_entry" },
                { "$ref": "#/$defs/separator_entry" }
            ]
        }
    }
}